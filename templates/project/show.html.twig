{% extends 'base.html.twig' %}

{% block title %}HouseBook | Project{% endblock %}

{% block body %}
        

    <div class="container-fluid">
    <div class="row first-row">
    
        <div class="col-12 col-sm-4 first-col">
            <img src={{asset ('/uploads/projects/'~ project.projectDirectory ~'/'~ project.profilePicture) }} class="project-image" alt="...">
        </div>
    
    <div class="col-12 col-sm-8">
      
    </div>
  </div>



</div>
  <div id="map"></div>
    <div id="infowindow-content">
        <span id="place-name" class="title">{{project.name}}</span><br />
        <span id="place-address" >{{project.Description}}</span><br />
    </div>
  <form method="post" action="{{ path('project_delete', {'slug': project.slug}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ project.slug) }}">
  <button class="btn btn-danger">Delete</button>
  </form>
    <h1>Add new Document</h1>
    <a href="{{ path('document_new', {'slug': project.slug}) }}" class="btn btn-secondary">Add</a>
    {% for document in project.documents %}
        <a href="{{ path('document_download', {'file': document.path}) }}">{{document.name}}</a>
    {% endfor %}



    {% for stage in project.stage %}

        <a href="{{ path('steps_new', {'slug': stage.slug}) }}" class="d-inline text-success"><i class="fas fa-solid fa-plus"></i>Add step</a>
        {{ include('stage/_delete_form.html.twig') }}
    {% endfor %}


    <script
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC_iCIeZYa54exJQEYuAXAtPkQvWWwxzkQ&callback=initMap&libraries=places&v=weekly"
            defer
    ></script>

<script>
    let map;
    let service;
    let infowindow;

    function initMap() {
        const project_lat = document.getElementById("project_lat").textContent;
        const project_lng = document.getElementById("project_lng").textContent;

        const project = new google.maps.LatLng(project_lat, project_lng);

        map = new google.maps.Map(document.getElementById("map"), {
            center: project,
            zoom: 15,
        });

        marker = new google.maps.Marker({
            position: project,
            map
        });
        const infowindow = new google.maps.InfoWindow();
        const infowindowContent = document.getElementById("infowindow-content");

        infowindow.setContent(infowindowContent);

        infowindow.open(map, marker);

    }

    window.initMap = initMap;
</script>
{% endblock %}
