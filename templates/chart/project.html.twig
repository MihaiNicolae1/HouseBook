{% extends 'base.html.twig' %}

{% block title %}Housebook | Stats{% endblock %}

{% block body %}



    <div class="first-row" onload="chartTracker()">
        <select id="chart-choice">
            <option value="month">Costs this year by month</option>
            <option value="year">Costs by years</option>
        </select>
        <div class="chart-container" style="position: relative; width:80%">
            <canvas id="cost-chart"></canvas>
        </div>
    </div>
    <script>
        const chartLabels = {{months|json_encode()|raw}};

        const chartData = {
            labels: chartLabels,
            datasets: [{
                label: 'Costs by month',
                backgroundColor: 'rgb(242, 103, 25, 0.3)',
                borderColor: 'rgb(242, 103, 25)',
                borderWidth: 2,
                borderRadius: Number.MAX_VALUE,
                data: {{monthCosts|json_encode()|raw}},
            }]
        };
        const chartConfig = {
            type: 'bar',
            data: chartData,
            options: {
                responsive: true,
                autoPadding : true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Costs by project',
                    }
                }
            }
        };
    </script>
    <script>

            const select = document.getElementById('chart-choice');
            const canvas = document.getElementById('cost-chart');
            const context = document.getElementById("cost-chart").getContext('2d');

            const costChart = new Chart(
                canvas,
                chartConfig
            );

            const chartChoice = document.getElementById('chart-choice');
            chartChoice.addEventListener('change',chartTracker);
            function  chartTracker(){
                if(chartChoice.value === 'year'){
                    costChart.data.datasets[0].data = {{test|json_encode()|raw}};
                    costChart.data.datasets[0].label = 'Costs by year'
                    costChart.config.options.plugins.title.text = 'text1';
                } else if (chartChoice.value ==='month'){
                    costChart.data.datasets[0].data = {{monthCosts|json_encode()|raw}};
                    costChart.data.datasets[0].label = 'Costs this year by month'
                    costChart.config.options.plugins.title.text = 'text2';
                }
                costChart.update();
            }
    </script>
{% endblock %}
